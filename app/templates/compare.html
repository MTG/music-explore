{% extends 'base.html' %}
{% set title = 'Compare' %}
{% set page = 'compare' %}

{% macro form() %}
    <div class="form-row justify-content-center align-items-end">
        <div class="col-auto form-group">
            <label class="d-block text-center" for="selector-architecture">Architecture</label>
            <select class="selectpicker form-control" id="selector-architecture" name="architecture">
                {% for key, value in data['architectures'].items() %}
                    <option value="{{ key }}">{{ value['name'] }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-auto form-group">
            <label class="d-block text-center" for="selector-dataset">Dataset</label>
            <select class="selectpicker form-control" id="selector-dataset" name="dataset">
                {% for key, value in data['datasets'].items() %}
                    <option value="{{ key }}">{{ value['name'] }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-auto form-group">
            <label class="d-block text-center" for="selector-layer">Layer</label>
            <select class="selectpicker form-control" id="selector-layer" name="layer">
                <option value="embeddings">Embeddings</option>
                <option value="taggrams">Taggrams</option>
            </select>
        </div>

        <div class="col-auto form-group">
            <label class="d-block text-center" for="selector-projection">Projection</label>
            <select class="selectpicker form-control" id="selector-projection" name="projection">
                <option value="pca">PCA</option>
                <option value="std-pca">STD-PCA</option>
                <option value="tsne">t-SNE</option>
                <option value="umap">UMAP</option>
{#                <option value="original">Original</option>#}
            </select>
        </div>

        <div class="col-auto form-group" style="display: none;">
            <label class="d-block text-center" for="selector-dimension-x">X</label>
            <select class="selectpicker form-control" id="selector-dimension-x" name="dimension-x"
                    data-live-search="true">
            </select>
        </div>

        <div class="col-auto form-group" style="display: none;">
            <label class="d-block text-center" for="selector-dimension-y">Y</label>
            <select class="selectpicker form-control" id="selector-dimension-y" name="dimension-y"
                    data-live-search="true">
            </select>
        </div>

        <div class="col-auto form-group">
            <button class="btn btn-success" type="submit" id="btn-refresh"><i class="fas fa-sync"></i></button>
        </div>
    </div>
{% endmacro %}

{% block content %}
    <div class="container-fluid h-100">
        <div class="row h-100">
            <div class="col-2">
                <form id="form-data" class="">
                    <div class="form-group">
                        <label class="" for="selector-tags">Tags ({{ tags | length }})</label>
                        <select class="selectpicker form-control" id="selector-tags" multiple name="tags"
                                data-live-search="true" data-actions-box="true">
                            {% for tag in tags %}
                                <option value="{{ tag.id }}">{{ tag.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="selector-artists">Artists ({{ artists | length }})</label>
                        <select class="selectpicker form-control" id="selector-artists" multiple name="artists"
                                data-live-search="true" data-actions-box="true">
                            {% for artist in artists %}
                                <option value="{{ artist.id }}">{{ artist.name | safe }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-success" type="submit" id="btn-refresh"><i class="fas fa-sync"></i></button>
                    </div>
                </form>

                <form id="form-highlight">
                    Highlight groups
                    <div class="form-group form-row">
                        <select class="col selectpicker form-control" name="filter-entity">
                            <option>Tag</option>
                            <option>Artist</option>
                            <option>Album</option>
                            <option>Track</option>
                        </select>
                        <select class="col selectpicker form-control" multiple name="filter-items">
                            <option>...</option>
                        </select>
                    </div>
                    <div class="form-group form-row">
                        <select class="col selectpicker form-control" name="filter-entity">
                            <option>Tag</option>
                            <option>Artist</option>
                            <option>Album</option>
                            <option>Track</option>
                        </select>
                        <select class="col selectpicker form-control" multiple name="filter-items">
                            <option>...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-primary" id="btn-add-filter">+</button>
                    </div>
                </form>

                <div>
                    <audio class="w-100" id="audio" controls></audio>
                    <div class="text-center" id="track-info"></div>
                </div>
            </div>
            <div class="col-5">
                <form id="form-left">
                    {{ form() }}
                </form>
                <div id="plot-left" class="plot"></div>
            </div>
            <div class="col-5">
                <form id="form-right">
                    {{ form() }}
                </form>
                <div id="plot-right" class="plot"></div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/commons.js') }}"></script>
    <script src="{{ url_for('static', filename='js/audio.js') }}"></script>
    <script src="{{ url_for('static', filename='js/compare.js') }}"></script>
{% endblock %}
